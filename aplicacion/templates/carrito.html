{% extends "base/base.html" %}
{% block titulo %} Carrito  {% endblock %}
{% block contenido %}  
  <div class="container border mt-2" id="carrito">
    <h3>Carrito de compras</h3>
    {% if not carrito_productos %}
    <div class="text-center m-1">
      <img class="mb-4 img-fluid" src="static/img/carrito.png" alt="" width="100" height="100">
      <h4>Busca productos para agregar al carrito</h4>
    </div>
    {% endif %}
    {% for carrito in carrito_productos %}
    <div class="row row-cols-1 row-cols-sm-1 row-cols-md-2 border mb-1 mt-1 align-items-center">
      <div class="col-md-3">
        <div class="d-flex align-items-center">
            <img src="{{ carrito.producto.imagen.url}}" alt="" class="img-fluid m-1" width="100"> 
            <p class="text-truncate m-1">{{ carrito.producto}}</p>
        </div>
      </div>
      <div class="col-md-9">
        <div class="d-flex align-items-center">
          <div class="d-flex align-items-center">
            {% csrf_token %}
            <span class="">Cantidad:</span>
            <select class="form-select form-select-sm m-1" aria-label=".form-select-sm example" id="cantidad-{{ carrito.id_carrito}}" name="cantidad" onchange="editar_carrito('{{ carrito.id_carrito}}')" {% if not carrito.cantidad_select %} disabled {% endif %}>
            {% if carrito.cantidad_select  %}
              {% for cantidad in carrito.cantidad_select %}
                {% if carrito.cantidad == cantidad %}
                  <option selected value="{{cantidad}}">{{cantidad}}</option>
                {% else %}
                  <option value="{{cantidad}}">{{cantidad}}</option>
                {% endif %}
              {% endfor%}
            {% else %}
              <option>Sin stock</option>
            {% endif %}
            </select>
          </div>
          <div>
            <button type="button" class="btn btn-secondary btn-sm " onclick="quitar_carrito('{{ carrito.id_carrito}}')">Eliminar</button>
          </div>
          <div class="col">
            {% if carrito.subtotal  %}
            <p class="d-flex justify-content-end m-1">$ {{ carrito.subtotal}}</p>
            {% endif %}
          </div>
        </div>
      </div>
    </div>
    {% endfor %}
    {% if carrito_productos %}
    {% if carrito_productos.total %}
    <div class="row row-cols-1 row-cols-sm-1 row-cols-md-auto justify-content-between border mt-2 ">
      <div class="col mb-1 mt-1">
        <h3>Total a pagar: $ {{ carrito_productos.total }}</h3>
      </div>
      <div class="col d-grid gap-2 mb-1 mt-1">
        <button type="submit" class="btn btn-primary">Comprar</button>
      </div>
    </div>
    {% endif %}
    {% endif %}
  </div>
  <!-- <style>
    .progress-bar-inicio{
      width: 0%;
    }
    .progress-bar{
      width: 100%;
    }
    .animacion{
      transition: all 2s ease .1s;
    }
  </style>
  <div class="progress" id="progress">
    <div class=" progress-bar-striped bg-success progress-bar-inicio animacion" id="barra-compra" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
  </div>
  <button onclick="animacion_compra()">animar</button> -->

{% endblock %}